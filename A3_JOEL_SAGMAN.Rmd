---
title: "A3_JOEL_SAGMAN"
author: "Joel Sagman"
date: "1/25/2022"
output: html_document
---

## Project Info
Github Username: JoelSagman
Github Link: https://github.com/JoelSagman/Assignment-3

### Load the FallopiaData.csv
```{r setup}
library(dplyr)
FaData<-read.csv("InputData/FallopiaData.csv")
```

### Data wrangling

a. Remove rows with ‘Total’ biomass < 60
b. Reorder the columns so that they are in the order: ‘Total’, ‘Taxon’, ‘Scenario’, ‘Nutrients’, and remove the other columns
c. Make a new column TotalG, which converts the ‘Total’ column from mg to grams AND replace Total with TotalG, and add it to the dataset.

```{r data wrang}
WrangData <- FaData %>%
  filter(Total < 60) %>%
  relocate(Total, Taxon, Scenario, Nutrients) %>%
  select(Total:Nutrients) %>%
  mutate(TotalG = Total * 1000, Total=NULL) 

```

### Custom Fuction
Write a custom function that will take two inputs from the user: 1. a vector of data to process (e.g. column from a data.frame object) and 2. a string that defines what calculation to perform.
1. if string #2 is "Average" then calculate the average value for the column named in vector #1 
2. if string #2 is "Sum" then calculate the sum of values for the column named in vector #1
3. if string #2 is "Observations" then count the number of observed values for the column named in vector #1
4. if string #2 is anything else, then output an error to the user 

```{r}
MyFunction<-function(WrangData,var1=0,var2="string"){
  if(var2=="Average"){
    (Average=mean(var1))
    return("Average"= Average)
  }
  if(var2=="Sum"){
    (Sum=sum(var1))
    return("Sum"= Sum)
  }
  if(var2=="Observations"){
    (Observations<-length(var1))
    return(Observations)
  }
  if(var2 != ""){
    return(print("error in user input"))
  }
}
```

a. Write some R code that uses your function to count the total number of observations in the 'Taxon' column.
b. Write some R code that uses your function  to calculate the average TotalG for each of the two Nutrient concentrations.
```{r}
(TotalTaxon<-MyFunction(var1=WrangData$Taxon,var2="Observations"))

(TotalG<-MyFunction(var1=WrangData$TotalG,var2="Average"))
```

Write (i.e. save) the new data to a file called "WrangledData.csv" in the Output folder. 
```{r}
write.csv(WrangData, "./Output/WrangledData.csv", row.names=F) #save data to output file 
```